<html>
    <head>
        <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
        <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    </head>
    <body>
        <div id="divSearch">
            <form action="http://127.0.0.1:8081/process_get" method="GET">
                <label for="categories" >Category:</label>&nbsp; 
                <select type="text" name="ddlCategory" id="ddlCategories"></select>  &nbsp;  &nbsp;                
                <label for="title"></label>Song: </label>&nbsp; 
                <input type="text" name="txtName" id="txtName">
                <input type="submit" value="Submit">
            </form>
        </div>
        
    </body>
    <script>
        $( document ).ready(function() {
            $.getJSON("http://localhost:3002/api/categories", {
                tags: "mount rainier",
                tagmode: "any",
                format: "json"
            }).done((data)=>{
                //alert(JSON.stringify(data));
                $.each(data, function(key, value) {
                    $("#ddlCategories").append("<option id="+value.id+">" + value.name + "</option>");
                });
            });
        });
        $( function() {
            $( "#txtName" ).autocomplete({
                minLength: 2,
                source: function( request, response ) {
                    // Fetch data
                    $.ajax({
                            url: "http://localhost:3002/api/songs",
                            type: 'post',
                            dataType: 'JSON',
                            data:{
                                id: $('#ddlCategory').children("option:selected").val(),
                                term: $('#txtName').text()
                            },
                            success: function( data ) {
                                console.log(data);
                                response( data );
                        }
                    });
                },
                select: function (event, ui) {
                    console.log(ui);
                    // Set selection
                    $('#txtName').val(ui.item.label); // display the selected text
                    //$('#selectuser_id').val(ui.item.value); // save selected id to input
                    return false;
                }
            });
        });
    </script>
</html>